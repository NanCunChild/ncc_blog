<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>Tech on NanCunChildのブログ</title>
    <link>http://localhost:1313/ja/tags/tech/</link>
    <description>Recent content in Tech on NanCunChildのブログ</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>ja-JP</language>
    
    
    <lastBuildDate>Thu, 27 Nov 2025 22:38:21 +0800</lastBuildDate>
    
        <atom:link href="http://localhost:1313/ja/tags/tech/index.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>さらばWordPress！NCCのHugo静的ブログ移行録</title>
      <link>http://localhost:1313/ja/posts/hugo_deploy_diary/</link>
      <pubDate>Thu, 27 Nov 2025 22:38:21 +0800</pubDate>
      
      <guid>http://localhost:1313/ja/posts/hugo_deploy_diary/</guid>
      
      <description>WordPressからHugoへ。阿里云からHostdareへのサーバー移転と、Docker+Nginxによる爆速静的サイト構築の完全ガイドです。Hello Friend NGテーマの設定、GitHub Actionsを用いたCI/CD自動デプロイの構築手順を解説。さらに、初心者がハマりやすいGo言語の日付フォーマットの罠や、多言語化（i18n）におけるルーティングエラーの解決策など、実用的な技術Tipsを共有します。</description>
      
      <content:encoded>
        <![CDATA[<p>さらば、NCCの重いサーバーよ～　NCC、サーバー引っ越しました！
事の発端は、阿里云から届いた「おい、公的機関への登録（ICP）忘れてるぞ」というメール。再申請を試みるも連敗続き（後で管轄エリアの間違いだと判明…トホホ）。</p>
<p>加えて、既存の200Mサーバーが <strong>「ジャガイモサーバー」</strong> 並みに重いことに不満が爆発（最低限度額のバンド幅じゃない）。そこで、HostdareのCN2 GIA回線（米国）を発見。月額12ドルで、他の海外サーバーのようなラグもなく、中国国内からのアクセスも爆速です。</p>
<p>バックアップ中に気づいたのが、旧ブログのWordPressの重さ。アクセスのたびにローディングの　<strong>「グルグル」</strong>　を見せられ、バックグラウンドではPHPが必死に動いている…。管理画面に入るだけで一苦労です。<br>
そこで頭をよぎったのが、HexoやHugoなどの静的サイトジェネレーター。「これならCDNも使えるし、WordPressの不要な機能ともオサラバして <strong>断捨離</strong> できる！」と思い立ちました。</p>
<p><strong>NCCは「Hugo」を装備した！</strong></p>
<p>WordPressが「客の注文を受けてから料理を作るシェフ」なら、Hugoは「食品加工工場」です。全記事を一気にコンパイルして、静的HTMLという <strong>「作り置き」</strong> にする。客が来たら、Nginxはそれを皿に出すだけ。<br>
このアーキテクチャなら、現代のクラウドサーバーどころか、20年前の化石PCでも爆速で動きます。CDNと組み合わせれば、コストゼロで大量アクセスを捌ける。まさに <strong>「神」</strong> 。</p>
<h2 id="hugoの初期化-hugo-initialization">Hugoの初期化 (Hugo Initialization)</h2>
<p>HugoはWordPressのような複雑な環境構築は不要。コマンドライン一つで終わります。<br>
以下のコマンドで、必要なディレクトリ構造が<strong>召喚</strong>されます：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>hugo new site . --force
</span></span></code></pre></div><p>後の管理のために、Gitでバージョン管理することを<strong>強く推奨（というより義務）</strong>　します：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git init
</span></span><span style="display:flex;"><span>git checkout main
</span></span><span style="display:flex;"><span>git add .
</span></span><span style="display:flex;"><span>git commit -m <span style="color:#e6db74">&#34;initialize&#34;</span>
</span></span><span style="display:flex;"><span>git remote add origin https://<span style="color:#f92672">{</span>Change_This_to_Your_Git_Repository_URL<span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>git push -u origin main
</span></span></code></pre></div><h2 id="テーマ選びそれは沼">テーマ選び：それは「沼」</h2>
<p>Hugoのテーマ選びは、ある意味「ガチャ」です。<br>
公式テーマサイトには沢山のテーマがありますが、ここには<strong>巨大な落とし穴</strong>があります。多くのテーマは個人開発で、品質がピンキリです。見た目だけで選ぶと、後でバグだらけのコードを見て **「虚無顔」**になる羽目になります。<br>
選ぶときは <strong>GitHubのStar数</strong>、<strong>Issuesの活発さ</strong>、<strong>ドキュメント</strong> を必ずチェックしましょう。</p>
<p>NCCは最終的に <a href="https://github.com/rhazdon/hugo-theme-hello-friend-ng">Hello Friend NG</a> を選びました。ドキュメントが丁寧でデザインもスッキリしています。<br>
インストールは <code>git clone</code> ではなく、<strong>Git Submodule</strong> を使うのがベストプラクティスです。作者の更新に追従しやすくなります。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>git submodule add https://github.com/rhazdon/hugo-theme-hello-friend-ng themes/hugo-theme-hello-friend-ng
</span></span></code></pre></div><h2 id="設定ファイルgo言語の洗礼">設定ファイル：Go言語の洗礼</h2>
<p>設定ファイルは <code>hugo.toml</code> 一つだけ。これがHugoのすべてを司ります。</p>
<p><strong>注意点（ハマりポイント）</strong>：<br>
日付フォーマットの設定に <code>Jan 02, 2006</code> という謎の日付が出てきます。NCCは最初、「なんで2006年？このプロジェクトそんなに古いの？」と思い、現在の日付に変えてしまいました。<br>
結果、ブログの日付が全壊。<br>
実はこれ、Go言語特有の **「仕様」**なんです。 <strong>2006年1月2日 15時04分</strong>という数字の並びがフォーマットの基準になっています。これは **「初見殺し」**すぎる…。</p>
<p>以下は、NCCが数々の<strong>地雷</strong>を踏み抜いた末に辿り着いた、<strong>本番環境用コンフィグ</strong>です（多言語対応のルーティング問題も解決済み）：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-toml" data-lang="toml"><span style="display:flex;"><span><span style="color:#a6e22e">baseURL</span> = <span style="color:#e6db74">&#39;https://blog.nancunchild.cn/&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">languageCode</span> = <span style="color:#e6db74">&#39;zh-CN&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">title</span> = <span style="color:#e6db74">&#39;NanCunChild的碎碎念&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">theme</span> = <span style="color:#e6db74">&#39;hugo-theme-hello-friend-ng&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">pagination</span>.<span style="color:#a6e22e">pagerSize</span> = <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">defaultContentLanguage</span> = <span style="color:#e6db74">&#39;zh-cn&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">defaultContentLanguageInSubdir</span> = <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#a6e22e">params</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">dateform</span>        = <span style="color:#e6db74">&#34;Jan 02, 2006&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">dateformShort</span>   = <span style="color:#e6db74">&#34;Jan 02&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">dateformNum</span>     = <span style="color:#e6db74">&#34;2006-01-02&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">dateformNumTime</span> = <span style="color:#e6db74">&#34;2006-01-02 15:04&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">subtitle</span> = <span style="color:#e6db74">&#34;NCC的碎碎念&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">description</span> = <span style="color:#e6db74">&#34;NanCunChild的个人博客，包含生活，技术和幻想&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">keywords</span> = <span style="color:#e6db74">&#34;homepage, blog, nancunchild, tech&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">images</span> = [<span style="color:#e6db74">&#34;assets/web_icon.ico&#34;</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">disableReadOtherPosts</span> = <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">enableSharingButtons</span> = <span style="color:#66d9ef">false</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">enableGlobalLanguageMenu</span> = <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">defaultTheme</span> = <span style="color:#e6db74">&#34;auto&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    [<span style="color:#a6e22e">params</span>.<span style="color:#a6e22e">author</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">name</span> = <span style="color:#e6db74">&#34;NanCunChild&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    [<span style="color:#a6e22e">params</span>.<span style="color:#a6e22e">contact</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">email</span> = <span style="color:#e6db74">&#39;nancunchild@gmail.com&#39;</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>[<span style="color:#a6e22e">languages</span>]
</span></span><span style="display:flex;"><span>    [<span style="color:#a6e22e">languages</span>.<span style="color:#a6e22e">zh-cn</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">languageCode</span> = <span style="color:#e6db74">&#39;zh-CN&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">languageName</span> = <span style="color:#e6db74">&#39;中文&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">weight</span> = <span style="color:#ae81ff">1</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">title</span> = <span style="color:#e6db74">&#39;NanCunChild的碎碎念&#39;</span>
</span></span><span style="display:flex;"><span>        [<span style="color:#a6e22e">languages</span>.<span style="color:#a6e22e">zh-cn</span>.<span style="color:#a6e22e">params</span>]
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">subtitle</span> = <span style="color:#e6db74">&#39;生活、技术与幻想&#39;</span>
</span></span><span style="display:flex;"><span>            [<span style="color:#a6e22e">languages</span>.<span style="color:#a6e22e">zh</span>.<span style="color:#a6e22e">params</span>.<span style="color:#a6e22e">homeInfoParams</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Title</span> = <span style="color:#e6db74">&#34;你好 👋&#34;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Content</span> = <span style="color:#e6db74">&#34;欢迎来到NCC的碎碎念&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        [[<span style="color:#a6e22e">languages</span>.<span style="color:#a6e22e">zh-cn</span>.<span style="color:#a6e22e">menu</span>.<span style="color:#a6e22e">main</span>]]
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">identifier</span> = <span style="color:#e6db74">&#34;about&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">name</span> = <span style="color:#e6db74">&#34;关于我&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">url</span> = <span style="color:#e6db74">&#34;/about/&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">weight</span> = <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>        [[<span style="color:#a6e22e">languages</span>.<span style="color:#a6e22e">zh-cn</span>.<span style="color:#a6e22e">menu</span>.<span style="color:#a6e22e">main</span>]]
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">identifier</span> = <span style="color:#e6db74">&#34;posts&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">name</span> = <span style="color:#e6db74">&#34;文章&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">url</span> = <span style="color:#e6db74">&#34;/posts/&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">weight</span> = <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>        [[<span style="color:#a6e22e">languages</span>.<span style="color:#a6e22e">zh-cn</span>.<span style="color:#a6e22e">menu</span>.<span style="color:#a6e22e">main</span>]]
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">identifier</span> = <span style="color:#e6db74">&#34;archives&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">name</span> = <span style="color:#e6db74">&#34;归档&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">url</span> = <span style="color:#e6db74">&#34;/archives/&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">weight</span> = <span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    [<span style="color:#a6e22e">languages</span>.<span style="color:#a6e22e">en</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">languageCode</span> = <span style="color:#e6db74">&#39;en-US&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">languageName</span> = <span style="color:#e6db74">&#39;English&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">weight</span> = <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">title</span> = <span style="color:#e6db74">&#34;NanCunChild&#39;s Blog&#34;</span>
</span></span><span style="display:flex;"><span>        [<span style="color:#a6e22e">languages</span>.<span style="color:#a6e22e">en</span>.<span style="color:#a6e22e">params</span>]
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">subtitle</span> = <span style="color:#e6db74">&#39;Tech, Life and Fantasy&#39;</span>
</span></span><span style="display:flex;"><span>            [<span style="color:#a6e22e">languages</span>.<span style="color:#a6e22e">en</span>.<span style="color:#a6e22e">params</span>.<span style="color:#a6e22e">homeInfoParams</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Title</span> = <span style="color:#e6db74">&#34;Hi there 👋&#34;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Content</span> = <span style="color:#e6db74">&#34;Welcome to NCC&#39;s Blog&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        [[<span style="color:#a6e22e">languages</span>.<span style="color:#a6e22e">en</span>.<span style="color:#a6e22e">menu</span>.<span style="color:#a6e22e">main</span>]]
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">identifier</span> = <span style="color:#e6db74">&#34;about&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">name</span> = <span style="color:#e6db74">&#34;About&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">url</span> = <span style="color:#e6db74">&#34;/en/about/&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">weight</span> = <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>        [[<span style="color:#a6e22e">languages</span>.<span style="color:#a6e22e">en</span>.<span style="color:#a6e22e">menu</span>.<span style="color:#a6e22e">main</span>]]
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">identifier</span> = <span style="color:#e6db74">&#34;posts&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">name</span> = <span style="color:#e6db74">&#34;Posts&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">url</span> = <span style="color:#e6db74">&#34;/en/posts/&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">weight</span> = <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>        [[<span style="color:#a6e22e">languages</span>.<span style="color:#a6e22e">en</span>.<span style="color:#a6e22e">menu</span>.<span style="color:#a6e22e">main</span>]]
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">identifier</span> = <span style="color:#e6db74">&#34;archives&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">name</span> = <span style="color:#e6db74">&#34;Archives&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">url</span> = <span style="color:#e6db74">&#34;/en/archives/&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">weight</span> = <span style="color:#ae81ff">20</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    [<span style="color:#a6e22e">languages</span>.<span style="color:#a6e22e">ja</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">languageCode</span> = <span style="color:#e6db74">&#39;ja-JP&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">languageName</span> = <span style="color:#e6db74">&#39;日本語&#39;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">weight</span> = <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">title</span> = <span style="color:#e6db74">&#39;NanCunChildのブログ&#39;</span>
</span></span><span style="display:flex;"><span>        [<span style="color:#a6e22e">languages</span>.<span style="color:#a6e22e">ja</span>.<span style="color:#a6e22e">params</span>]
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">subtitle</span> = <span style="color:#e6db74">&#39;生活、技術とファンタジー&#39;</span>
</span></span><span style="display:flex;"><span>            [<span style="color:#a6e22e">languages</span>.<span style="color:#a6e22e">ja</span>.<span style="color:#a6e22e">params</span>.<span style="color:#a6e22e">homeInfoParams</span>]
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Title</span> = <span style="color:#e6db74">&#34;こんにちは 👋&#34;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#a6e22e">Content</span> = <span style="color:#e6db74">&#34;NCCのブログへようこそ&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        [[<span style="color:#a6e22e">languages</span>.<span style="color:#a6e22e">ja</span>.<span style="color:#a6e22e">menu</span>.<span style="color:#a6e22e">main</span>]]
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">identifier</span> = <span style="color:#e6db74">&#34;about&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">name</span> = <span style="color:#e6db74">&#34;プロフィール&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">url</span> = <span style="color:#e6db74">&#34;/ja/about/&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">weight</span> = <span style="color:#ae81ff">5</span>
</span></span><span style="display:flex;"><span>        [[<span style="color:#a6e22e">languages</span>.<span style="color:#a6e22e">ja</span>.<span style="color:#a6e22e">menu</span>.<span style="color:#a6e22e">main</span>]]
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">identifier</span> = <span style="color:#e6db74">&#34;posts&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">name</span> = <span style="color:#e6db74">&#34;記事一覧&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">url</span> = <span style="color:#e6db74">&#34;/ja/posts/&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">weight</span> = <span style="color:#ae81ff">10</span>
</span></span><span style="display:flex;"><span>        [[<span style="color:#a6e22e">languages</span>.<span style="color:#a6e22e">ja</span>.<span style="color:#a6e22e">menu</span>.<span style="color:#a6e22e">main</span>]]
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">identifier</span> = <span style="color:#e6db74">&#34;archives&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">name</span> = <span style="color:#e6db74">&#34;アーカイブ&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">url</span> = <span style="color:#e6db74">&#34;/ja/archives/&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a6e22e">weight</span> = <span style="color:#ae81ff">20</span>
</span></span></code></pre></div><h2 id="ブログ更新の自動化ロマンを求めて">ブログ更新の自動化：ロマンを求めて</h2>
<p>ブログを書く流れを<strong>エレガント</strong>にしたい。<br>
執筆はローカルの VS Code (MD拡張機能) か Obsidian で行います。特に Obsidian は余計なものがなく、**「Zenモード」**で執筆に集中できるのでお気に入りです。</p>
<p>デプロイ（アップロード）の手法ですが、NCCは「手動でアップロード」なんて泥臭いことはしたくありません。<br>
<strong>「Git Push したら勝手に更新される」</strong>。これこそがエンジニアの<strong>ロマン</strong>です。</p>
<p>NCCのワークフローはこうです：</p>
<ol>
<li>端末で記事を書く</li>
<li>GitHubへPush</li>
<li>GitHub Actions (CI/CD) がビルド</li>
<li>rsync でサーバーへデプロイ</li>
</ol>
<p>NCCは最初、「ビルドなんてGitHubに任せたら遅いのでは？」と思っていましたが、実際は数秒で終わります。サーバーに負荷をかけず、GitHubに働いてもらう。セキュリティ的にも、サーバーがGitHubへポーリングするより、鍵認証でPushさせる方がスマートです。</p>
<p>以下がNCCの<strong>秘伝のタレ</strong>です：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-toml" data-lang="toml"><span style="display:flex;"><span><span style="color:#a6e22e">name</span><span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#a6e22e">Deploy</span> <span style="color:#a6e22e">Hugo</span> <span style="color:#a6e22e">to</span> <span style="color:#a6e22e">NCC</span> <span style="color:#a6e22e">Server</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">on</span><span style="color:#960050;background-color:#1e0010">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">push</span><span style="color:#960050;background-color:#1e0010">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">branches</span><span style="color:#960050;background-color:#1e0010">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">-</span> <span style="color:#a6e22e">main</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">workflow_dispatch</span><span style="color:#960050;background-color:#1e0010">:</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">jobs</span><span style="color:#960050;background-color:#1e0010">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">build-and-deploy</span><span style="color:#960050;background-color:#1e0010">:</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">runs-on</span><span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#a6e22e">ubuntu-latest</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">steps</span><span style="color:#960050;background-color:#1e0010">:</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">-</span> <span style="color:#a6e22e">name</span><span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#a6e22e">Checkout</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">uses</span><span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#a6e22e">actions</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">checkout</span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#a6e22e">v4</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">with</span><span style="color:#960050;background-color:#1e0010">:</span>
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">submodules</span><span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">fetch-depth</span><span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">-</span> <span style="color:#a6e22e">name</span><span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#a6e22e">Setup</span> <span style="color:#a6e22e">Hugo</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">uses</span><span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#a6e22e">peaceiris</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">actions-hugo</span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#a6e22e">v2</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">with</span><span style="color:#960050;background-color:#1e0010">:</span>
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">hugo-version</span><span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#e6db74">&#39;latest&#39;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">extended</span><span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#66d9ef">true</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">-</span> <span style="color:#a6e22e">name</span><span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#a6e22e">Build</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">run</span><span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#a6e22e">hugo</span> <span style="color:#a6e22e">--minify</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">-</span> <span style="color:#a6e22e">name</span><span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#a6e22e">Setup</span> <span style="color:#a6e22e">SSH</span> <span style="color:#a6e22e">Key</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">uses</span><span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#a6e22e">shimataro</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">ssh-key-action</span><span style="color:#960050;background-color:#1e0010">@</span><span style="color:#a6e22e">v2</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">with</span><span style="color:#960050;background-color:#1e0010">:</span>
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">key</span><span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#960050;background-color:#1e0010">$</span>{{ <span style="color:#a6e22e">secrets</span>.<span style="color:#a6e22e">SSH_KEY</span> }}
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">known_hosts</span><span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#e6db74">&#39;just-a-placeholder-so-we-dont-get-errors&#39;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">if_key_exists</span><span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#a6e22e">replace</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">-</span> <span style="color:#a6e22e">name</span><span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#a6e22e">Add</span> <span style="color:#a6e22e">Known</span> <span style="color:#a6e22e">Hosts</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">run</span><span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#a6e22e">ssh-keyscan</span> <span style="color:#a6e22e">-H</span> <span style="color:#960050;background-color:#1e0010">$</span>{{ <span style="color:#a6e22e">secrets</span>.<span style="color:#a6e22e">HOST</span> }} <span style="color:#960050;background-color:#1e0010">&gt;&gt;</span> <span style="color:#960050;background-color:#1e0010">~/</span>.<span style="color:#a6e22e">ssh</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">known_hosts</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#a6e22e">-</span> <span style="color:#a6e22e">name</span><span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#a6e22e">Deploy</span> <span style="color:#a6e22e">with</span> <span style="color:#a6e22e">rsync</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a6e22e">run</span><span style="color:#960050;background-color:#1e0010">:</span> <span style="color:#960050;background-color:#1e0010">|</span>
</span></span><span style="display:flex;"><span>          <span style="color:#75715e"># attention, path problem</span>
</span></span><span style="display:flex;"><span>          <span style="color:#a6e22e">rsync</span> <span style="color:#a6e22e">-avz</span> <span style="color:#a6e22e">--delete</span> <span style="color:#a6e22e">public</span><span style="color:#960050;background-color:#1e0010">/</span> <span style="color:#960050;background-color:#1e0010">$</span>{{ <span style="color:#a6e22e">secrets</span>.<span style="color:#a6e22e">USER</span> }}<span style="color:#960050;background-color:#1e0010">@$</span>{{ <span style="color:#a6e22e">secrets</span>.<span style="color:#a6e22e">HOST</span> }}<span style="color:#960050;background-color:#1e0010">:/</span><span style="color:#a6e22e">var</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">www</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">ncc_sites</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">ncc_blog</span><span style="color:#960050;background-color:#1e0010">/</span><span style="color:#a6e22e">html</span>
</span></span></code></pre></div><p><strong>セキュリティの基本</strong>：GitHub用のユーザーは権限を絞りましょう。「最小権限の原則」です。</p>
<h2 id="ラスボスi18n">ラスボス：i18n</h2>
<p>すべて順調かと思いきや、最後の最後に<strong>i18n（国際化）<strong>というラスボスが立ちはだかりました。<br>
日・英・中の3ヶ国語対応を目指したのですが、なぜか中国語（簡体字）だけ 404 エラーになるか、英語に戻される…。<br>
ここから2時間、ソースコードを読み漁り、Nginxの設定を睨みつけ、Gemini先生に泣きつく</strong>デバッグ地獄</strong>が始まりました。</p>
<p>犯人は <strong>「言語コード」</strong> でした。</p>
<p>簡体字のファイル名は <code>zh-CN.toml</code> なので、設定ファイルでも <code>[languageCode = 'zh']</code> ではなく <code>zh-cn</code> と明記する必要があったのです。他の言語は2文字なのに、中国語だけ4文字…。</p>
<p>まさに<strong>罠</strong>でした。幸いなことに日本語は必要ありません。</p>
<h2 id="現在の状況">現在の状況</h2>
<p>現在、NCCブログは Docker コンテナ内の Nginx で稼働中。</p>
<ul>
<li><strong>性能</strong>：爆速。CPU使用率は誤差レベル。</li>
<li><strong>安全</strong>：静的ファイルなので SQLインジェクション？何それおいしいの？状態。</li>
<li><strong>体験</strong>：Obsidianで書く -&gt; Push -&gt; 自動デプロイ。</li>
</ul>
<p>**「圧倒的成長」**を感じる快適さです。GitHub Actionsが失敗したらメールで教えてくれるので、枕を高くして眠れます。</p>
]]>
      </content:encoded>
    </item>
    
  </channel>
</rss>